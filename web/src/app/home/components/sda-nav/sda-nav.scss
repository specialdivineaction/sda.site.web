@mixin ng-fade {
   opacity: 1;
   transition: opacity 0.4s;

   &.ng-hide {
      opacity: 0;
   }
}

@mixin reset-box-model {
   margin: 0;
   padding: 0;
   border: 0;
   outline: 0;
}

.main-nav {
   @include reset-box-model;
   height: 100%;

   display: flex;
   flex-direction: column;

   max-width: 100%;

   background-color: #f2f2f0;

   @media only all and (min-width: 64em) {
      flex-direction: row;
   }

   .buckets {
      @include reset-box-model;
      list-style: none;

      display: flex;
      flex-direction: column;

      @media only all and (min-width: 31em) {
         flex-direction: row;
      }

      @media only all and (min-width: 64em) {
         flex-direction: column;
         min-width: 300px;
         max-width: 300px;
      }

      .bucket {
         @include reset-box-model;

         flex: 1;
         display: flex;

         @extend %AvenirLTStd-Heavy;
         background-color: #b88554;
         border-bottom: 1px solid #a47140;
         overflow: hidden;

         &:last-child {
            border-bottom: 0;
         }

         &.active {
            background-color: #a47140;
         }

         @media only all and (min-width: 31em) {
            border: 0;
            border-right: 1px solid #a47140;

            &:last-child {
               border-right: 0;
            }
         }

         @media only all and (min-width: 64em) {
            border-bottom: 1px solid #a47140;
            border-right: 0;

            &:last-child {
               border-bottom: 0;
            }
         }

         a {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;

            color: #fff;
            font-size: 1em;
            line-height: 1.8;
            text-decoration: none;
            text-transform: uppercase;
            padding: 1.5rem;

            &:hover, &:focus, &:active {
               text-decoration: none;
            }

            @media only all and (min-width: 40em) {
               padding-left: 2rem;
               padding-right: 2rem;
            }

            @media only all and (min-width: 60em) {
               padding-left: 3rem;
               padding-right: 3rem;
            }
         }
      }
   }

   .modules {
      flex: 1;

      position: relative;

      .module {
         @include ng-fade;

         position: absolute;
         top: 0;
         bottom: 0;
         left: 0;
         right: 0;

         display: flex;
         flex-direction: column;

         .controls {
            @include reset-box-model;
            list-style: none;

            display: flex;
            flex-flow: row wrap;

            @extend %AvenirLTStd-Heavy;
            background-color: #e8e7e3;
            text-transform: uppercase;
            border-bottom: 4px solid #dfddd5;
            vertical-align: bottom;
            font-size: 0.9em;

            @media only all and (min-width: 50em) {
               padding-top: 3rem;
            }

            li {
               flex: 1;

               text-align: center;
               border: 1px solid #dfddd5;
               padding: 1rem 1.5rem;
               min-width: 50%;

               @media only all and (min-width: 50em) {
                  border: 0;
                  line-height: 1.2;
                  margin: 0 2.5rem 0 0;
                  padding: 0 0 1.25rem;
                  min-width: 0;
               }

               @media only all and (min-width: 60em) {
                  margin: 0 2rem 0 0;
               }

               &.active a {
                  color: #b88554;

                  @media only all and (min-width: 50em) {
                     color: #b88554;

                     &:before {
                        background-color: white;
                        bottom: -1.5rem;
                        content: '';
                        display: block;
                        height: 4px;
                        position: absolute;
                        width: 100%;
                     }
                  }
               }

               a {
                  color: #acaaa3;
                  display: inline-block;
                  position: relative;
                  text-decoration: none;

                  &:hover, &:focus, &:active {
                     color: #b88554;
                     outline: 0;
                  }
               }
            }
         }

         .panels {
            flex: 1;
            position: relative;

            .panel-set {
               @include ng-fade;
               position: absolute;
               top: 0;
               bottom: 0;
               left: 0;
               right: 0;

               display: flex;
               flex-direction: column;

               header {
                  text-align: center;
                  margin: 1em 10%;
                  background: #a47140;
                  color: #fff;
                  padding: 0.5em;
                  font-size: 120%;
                  border-radius: 8px;
                  line-height: 1.3;

                  p:last-child {
                     margin-bottom: 0;
                  }
               }

               .row, .col {
                  flex: 1;
                  display: flex;

                  @media only all and (min-width: 40em) {
                     padding: 2em;
                  }

                  > * {
                     flex: 1;
                  }

                  > figure {
                     flex-grow: 2;
                  }
               }

               .row {
                  flex-direction: column;

                  @media only all and (min-width: 40em) {
                     flex-direction: row;
                  }

                  &.border > * {
                     border-top: 2px dotted #bbb;

                     @media only all and (min-width: 40em) {
                        border-top: none;
                        border-left: 2px dotted #bbb;
                     }

                     &:first-child {
                        border-top: none;
                        border-left: none;
                     }
                  }
               }

               .col {
                  flex-direction: column;

                  &.border > * {
                     border-top: 2px dotted #bbb;

                     &:first-child {
                        border-top: none;
                     }
                  }
               }

               .panel {
                  padding: 2em;

                  &.center-v {
                     display: flex;
                     align-items: center;
                  }

                  &.center-h {
                     display: flex;
                     justify-content: center;
                  }

                  figure {
                     position: relative;
                     overflow: hidden;
                     width: 100%;

                     img, iframe {
                        width: 100%;
                        display: block;
                        margin: 0 auto;
                     }
                  }

                  h3 {
                     font-size: 1.8em;
                     line-height: 1.2;
                     margin: 0 0 1rem;
                  }

                  p {
                     font-size: 0.9em;
                  }
               }
            }
         }
      }
   }
}
