<main class="section--article">
   <div class="container">
      <sda-tabbed-sidebar fixed="true" toplink="true" backlink="true" go-back="vm.goBack()" active-tab="vm.activeTab">
         <sda-sidebar-tab class="toc" title="Contents" icon="list" id="toc">
            <ol dx-start-with="vm.toc" du-scrollspy-context>
               <li ng-repeat="node in $dxPrior.children" du-scrollspy="{{node.id}}" offset="{{vm.scrollOffset}}">
                  <a ui-sref="sda.reader-article({id: vm.article.id, scrollTo: node.id})" ng-click="vm.scrollTo(node.id, true, $event)">{{node.text}}</a>
                  <ol dx-connect="node"/>
               </li>
            </ol>
         </sda-sidebar-tab>
         <sda-sidebar-tab class="links" title="Links" icon="link" id="links">
            <ul>
               <li ng-repeat="link in vm.article.links" class="related related-{{link.type}}">
                  <i class="icon fa fa-{{link.icon}}"></i>
                  <a href="{{link.uri}}" rel="{{link.rel}}" ng-click="vm.goToLink(link, $event)">{{link.title}}</a>
               </li>
            </ul>
         </sda-sidebar-tab>
         <sda-sidebar-tab class="notes" title="Footnotes" icon="sticky-note-o" id="footnotes">
            <ol du-scrollspy-context>
               <li ng-repeat="note in vm.article.footnotes" ng-class="{active: note.active}" du-scrollspy="{{note.backlinkId}}" offset="{{vm.scrollOffset}}">
                  <a ui-sref="sda.reader-article({id: vm.article.id, scrollTo: note.backlinkId})" ng-click="vm.activateNote(note, $event)" ng-model="note.text" mathjax></a>
               </li>
            </ol>
         </sda-sidebar-tab>
         <sda-sidebar-tab class="refs" title="Bibliography" icon="exchange" id="bibliography">
            <ol>
               <li ng-repeat="item in vm.bibliography" ng-bind-html="item"></li>
            </ol>
         </sda-sidebar-tab>
      </sda-tabbed-sidebar>
      <article>
         <div class="meta">
            <nav class="depth-chooser">
               <ul>
                  <li><a href="">Summary</a></li>
                  <li><a href="">Overview</a></li>
                  <li class="active"><a href="">Detailed Article</a></li>
               </ul>
            </nav>
            <h1>{{vm.article.title}}</h1>
            <p class="author-info" ng-if="vm.article.authors">
               by
               <span class="author" ng-repeat="author in vm.article.authors">
                  <a ng-if="author.contact.email" href="mailto:{{author.contact.email}}">{{author.name}}</a>
                  <span ng-if="!author.contact.email">{{author.name}}</span>
               </span>
            </p>
         </div>
         <article-parser body="vm.article.body" generate-toc="vm.toc = toc" footnotes="vm.article.footnotes" citations="vm.citations"></article-parser>
      </article>
   </div>
</main>
