$sidebar-bg: #f0f0f0;
$active-bg: darken($sidebar-bg, 5%);

.section--article {
   background: #333;

   h2 {
      color: $textGrey;
   }

   > .container {
      background: #fff;

      > .sidebar, > article {
         box-sizing: border-box;
      }

      > .sidebar > .panes, > article {
         padding: 2rem 1rem;

         @media screen and (min-width: $screen-sm-min) {
            padding: 2rem 3rem;
         }

         @media screen and (min-width: $screen-md-min) {
            padding: 2rem 1rem;
         }

         @media screen and (min-width: $screen-lg-min) {
            padding: 2rem;
         }
      }

      > article {
         position: relative;
         margin-left: 25%;
         padding-left: 4rem;

         .meta {
            margin-bottom: 2.5rem;

            .depth-chooser {
               position: absolute;
               top: 2rem;
               right: 2rem;

               ul {
                  padding: 0;
                  margin: 0;
                  list-style: none;

                  li {
                     display: inline-block;
                     padding: 0 1rem;

                     a {
                        color: $textGrey;
                        padding: 0 0 0.3rem;
                        text-decoration: none;

                        &:hover, &:focus {
                           border-bottom: 2px solid $textGrey;
                        }

                        &:focus, &:active {
                           outline: none;
                        }
                     }


                     &.active a {
                        color: $text;
                        border-bottom: 2px solid $copper;
                     }
                  }
               }
            }

            h1 {
               margin-bottom: 0.5rem;
            }

            .author-info {
               margin: 0;
               font-size: 1.3em;
            }
         }

         section {
            margin: 1em 0;
         }
      }

      > .sidebar {
         position: fixed;
         width: 25%;
         max-width: ($container-max-width / 4);
         margin-right: 2rem;
         bottom: 0;
         top: $header-height;

         flex: 1;
         background: $sidebar-bg;
         border-bottom: none;
         padding-left: 0;
         padding-top: 0;

         nav.tabs {
            position: absolute;
            top: 0;
            left: 100%;
            transform: rotate(90deg);
            transform-origin: bottom left;

            $active-bg: $sidebar-bg;
            $active-fg: black;
            $focus-bg: darken($sidebar-bg, 1%);
            $focus-fg: $active-bg;
            $inactive-bg: darken($sidebar-bg, 10%);
            $inactive-fg: #999;


            ul {
               margin: 0;
               padding: 0;
               list-style: none;
               white-space: nowrap;

               li {
                  display: inline-block;

                  a {
                     position: relative;
                     display: block;
                     background: $inactive-bg;
                     color: $inactive-fg;
                     cursor: pointer;
                     line-height: 2rem;
                     padding: 0 1rem 0 0;
                     margin-left: 1rem;
                     transition: background 0.3s;

                     &:before {
                        display: block;
                        content: '';
                        border-width: 1rem 0.5rem;
                        border-style: solid;
                        border-color: transparent $inactive-bg $inactive-bg transparent;
                        position: absolute;
                        left: -1rem;
                        transition: border-color 0.3s;
                     }

                     &:hover, &:focus {
                        background: $focus-bg;
                        &:before {
                           border-color: transparent $focus-bg $focus-bg transparent;
                        }
                     }

                     .icon {
                        transform: rotate(-90deg);
                        margin-right: 0.2em;
                     }
                  }


                  &.active a {
                     background: $active-bg;
                     color: $active-fg;

                     &:before {
                        border-color: transparent $active-bg $active-bg transparent;
                     }
                  }
               }
            }
         }

         .panes {
            max-height: 100%;
            overflow: auto;
         }

         .toc > ol {
            list-style: none;
            margin: 0;
            padding: 0;

            ol {
               list-style: none;
               margin: 0;
               padding: 0;
               margin-left: 1em;
               display: none;
            }

            li {
               margin: 0.3em 0;

               a {
                  color: $textBrown;
                  display: block;
                  padding: 0.3em 0.6em;
                  border-radius: 4px;
                  outline: 0;
                  text-decoration: none;

                  &:hover {
                     background: $active-bg;
                  }

                  &:focus {
                     color: $textBrown;
                     background: inherit;
                  }
               }

               &.active {
                  & > a {
                     background: $active-bg;
                     color: $lightBrown;
                  }

                  & > ol {
                     display: block;
                  }
               }
            }
         }

         .notes {
            font-size: 0.9em;
            line-height: 1.3;

            ol {
               margin: 0;
               padding: 0 0 0 1.5em;
               list-style: none;
               counter-reset: notes;

               li {
                  position: relative;
                  margin: 0.5rem 0;
                  color: #777;
                  cursor: pointer;

                  &:before {
                     position: absolute;
                     left: -1.5em;
                     content: counter(notes)  '.';
                     counter-increment: notes;
                  }

                  div {
                     width: 100%;
                     white-space: nowrap;
                     overflow: hidden;
                     text-overflow: ellipsis;
                  }

                  &.active {
                     color: black;
                     cursor: auto;

                     div {
                        white-space: normal;
                     }
                  }
               }
            }
         }

         a.toplink {
            position: absolute;
            right: 1rem;
            bottom: 1rem;
            display: block;
            text-decoration: none;
            outline: 0;

            .label {
               opacity: 0;
               transition: opacity 0.4s;
            }

            &:hover .label {
               opacity: 1;
            }
         }
      }
   }
}
